<ion-view>
    <ion-header-bar class="bar bar-header bar-stable nav-title-slide-ios7">
        <a class="button icon-left ion-ios7-arrow-back button-clear float-left" ui-sref="intro">
            {{ 'Back' | translate}}
        </a>
    </ion-header-bar>
    <ion-content class="dark-overlay has-header-main">
        <h1 class="align-center intro">{{ 'intro.Entity selection' | translate }}</h1>
		<div class="first-connexion-block">
			<ion-list>
				<ion-item class="item-divider item-positive item-select-red">
					{{ 'Entity' | translate }}
					<span class="item-note">
					  {{ userPreferences.entity }}
					</span>
				</ion-item>
				<div ng-repeat="item in entities">
					<ion-item class="item-stable"
							  ng-click="toggleGroup(item)"
							  ng-class="{active: isGroupShown(item)}"
							  ng-value="item.branch"
							>
						<i class="icon" ng-class="isGroupShown(item) ? 'ion-minus' : 'ion-plus'"></i>
						&nbsp;
						{{ item.branch | translate }}
					</ion-item>
					<ion-radio class="item-accordion"
							   ng-repeat="entity in item.entities|orderObjectBy:'text'"
							   ng-show="isGroupShown(item)"
							   ng-model="$root.userPreferences.entity"
							   ng-value="entity.text"
							   ng-change="updateUserPreferences()"
							   ui-sref="intro"
							>
						{{entity.text}}
					</ion-radio>
				</div>
			</ion-list>
		</div>
    </ion-content>
</ion-view>